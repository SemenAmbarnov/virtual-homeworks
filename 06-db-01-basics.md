# Домашнее задание к занятию "6.1. Типы и структура СУБД"


### Задача №1 

Архитектор ПО решил проконсультироваться у вас, какой тип БД лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

* Электронные чеки в json виде
* Склады и автомобильные дороги для логистической компании
* Генеалогические деревья
* Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
* Отношения клиент-покупка для интернет-магазина

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

Решение: 

* Документо-орентированный NoSQL - так как хранение чеков представляет собой всегда разный набор товаров и предусмотреть схему данных очень сложно, а зачастую невозможно. Здесь же каждый чек представляет собой отдельный документ.
* Графовые БД - возможность построения маршрутов в виде графов которые будут наглядно отображать схему складов и дорог.
* Иерархическая БД или графовые - здесь не до конца понятно какую БД применить так как с одной стороны иерархическая бд идеально подходит, но наглядно не учитывает все родственные связи, а только лишь следует схеме родитель-потомок. Тогда как в графовой системе есть возможность проследить связи всех родственников между друг другом. Если можно проясните пожалуйста этот момент.
* База данных ключ-значение, например Redis и Memcached - за счёт возможности кэширования ускоряется процесс доступа к данным. 
* Реляционные БД - обеспечивается связь между таблицами и всегда можно посмотреть количество доступного товара на количество покупателей.


### Задача №2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если (каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

* Данные записываются на все узлы с задержкой до часа (асинхронная запись)
* При сетевых сбоях, система может разделиться на 2 раздельных кластера
* Система может не прислать корректный ответ или сбросить соединение


Решение:

* AP - доступность+устойчивость к разделению 
* AP - доступность+устойчивость к разделению
* CP - косистентность+устойчивость к разделению 

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

В данной теореме мы видим не просто треугольник СAP, а условное дерево, которое можно представить в виде if (P, then A or C, else L or C), где есть уж (P)artitioning, (A)valability, (С)onsistency, а также новое понятие (L)atency – общее время задержки от момента выполнения действия пользователем до момента предоставления ему результата. 

* PA/EC - доступность+устойчивость к разделению или консистентность
* PA/EL - доступность+устойчивость к разделению или скорость ответа 
* PC/EC - доступность+констистентность или консистентность 

### Задача №3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

Решение:

* Не могут, так как основные принципы работы противорячат друг другу. BASE - доступность в любой ситуации в ущерб согласованности. ASID - на первом месте стоит согласованность и точность данных всех элементов кластера. Хотя современные условия бизнеса выдвигают требования для использования в система обеих систем, и использования частей элементов из обоих принципов, но согласно теореме CAP это практически невозможно.

### Задача №4

Вам дали задачу написать системное решение, основой которого бы послужили:

* фиксация некоторых значений с временем жизни
* реакция на истечение таймаута
Вы слышали о key-value хранилище, которое имеет механизм Pub/Sub. Что это за система? Какие минусы выбора данной системы?

Решение:

Судя по описанию задачи речь идёт о БД Redis. Так как данная система поддерживает механизм издатель-подписчик обладает функцией TTL(time-to-life)

Минусы БД REDIS
* как минус так и плюс - данные загружаются в оперативную память что повышает быстродействие, но есть риск потери данных при задержке отправки данных в хранилице или между снапшотами сервера
* сделал вывод из предыдущего пункта, необходимость сборки кластера с функцией sentinel. 
* так же как минус так и плюс это однопоточность - плюсом является то что есть возможность использовать на слабом железе, а минусом ограниченность в использовании ресурсов сервера/кластера серверов при их избыточности.
* Принцип работы на основе загрузки в оперативную память выдвигает требования к надёжности и качеству коплектующих, необходим мониторинг по утилизации. Ну вообще так себе минус, ведь это необходимо делать на любых устройствах содержащих БД. Но всё таки решил отметить. Так как нагрузка на узел ОЗУ возрастает. 

Вообще хотелось бы отметить что у данной системы на мой взгляд нет критических минусов. Все они вписываются в теорему CAP. Здесь же на лицо явный перекос в сторону быстродействия, удобства управления и простоты разворачивания. А при разворачиванииsentinel риск потери данный(считаю что самый критичный пункт для любой БД) сводиться к минимуму. Хотя почитав про sentinel пришёл к выводу что здесь тоже не так всё просто, если речь идёт о согласованности узлов(кворума) после выхода одного из них. Рекомендуется иметь нечётное количество узлов, и также утверждается что если при разделении сети на кворуме ведущий экземпляр Redis окажется в меньшей группеЮ,то при полном восстановлении системы данные на нём будут утеряны. P.S процесс согласования sentinel очень похож на docker swarm.


